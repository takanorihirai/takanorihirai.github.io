var epub_array=["epub/moby-dick.epub","epub/arisihino_uta.epub","epub/choifurudougu.epub","epub/chumonno_oi_ryoriten.epub","epub/gaitokidan.epub","epub/harapekorobot.epub","epub/naigai_guide.epub","epub/ondemand.epub","epub/oretoshoujyo.epub","epub/alice.epub"],index_epub=getParameterByName("e");console.log("index_epub",index_epub),index_epub&&0!=index_epub.length||(index_epub=0),console.log("index_epub",index_epub),epub_array[index_epub]||(index_epub=0);var url_epub=getCurrentUrlPath()+epub_array[index_epub];console.log("url_epub",url_epub);var book=ePub(url_epub),rendition=book.renderTo("viewer",{flow:"paginated",width:"100%",height:"100%",allowScriptedContent:!0}),displayed=rendition.display();displayed.then((function(renderer){console.log("renderer",renderer);var currentLocation=rendition.currentLocation();console.log("currentLocation",currentLocation);var c=book.locations.percentageFromCfi(currentLocation.start.cfi)})),book.loaded.navigation.then((function(toc){console.log("toc",toc),console.log("book",book),console.log("rendition",rendition)}));var next=document.getElementById("next");next.addEventListener("click",(function(){rendition.next()}),!1);var prev=document.getElementById("prev");prev.addEventListener("click",(function(){rendition.prev()}),!1);var keyListener=function(e){37==(e.keyCode||e.which)&&rendition.prev(),39==(e.keyCode||e.which)&&rendition.next()};rendition.on("relocated",(function(location){console.log("location",location);var nodeMessage=document.getElementById("message");location.hasOwnProperty("atStart")?(console.log("atStart"),nodeMessage.textContent="最初のページ"):location.hasOwnProperty("atEnd")?(console.log("atEnd"),nodeMessage.textContent="最後のページ"):(console.log("normal"),nodeMessage.textContent="");var percent=book.locations.percentageFromCfi(location.start.cfi),percentage=Math.floor(100*percent);console.log("percentage",percentage),console.log("book",book),console.log("rendition",rendition)})),rendition.on("keyup",keyListener),document.addEventListener("keyup",keyListener,!1);